{% extends "base.html" %} {% block title %}新規投稿 - ConnectU{% endblock %} {%
block content %}
<div class="timeline-container">
  <h2>新規投稿</h2>
  <div class="post-form">
    <form method="POST">
      <div class="mb-3">
        <label for="channel" class="form-label">チャンネル</label>
        <select name="channel" id="channel" class="form-select" required>
          {% for channel in get_all_channels() %}
          <option value="{{ channel.code }}" 
            {% if channel.code == default_channel %}selected{% endif %}>
            {{ channel.name }}
          </option>
          {% endfor %}
        </select>
      </div>
      <div class="mb-3">
        <label for="content" class="form-label">投稿内容</label>
        <textarea
          class="form-control"
          id="content"
          name="content"
          rows="3"
          maxlength="140"
          required
        ></textarea>
        <div class="char-counter mt-1"><span id="charCount">0</span>/140</div>
      </div>
      <button type="submit" class="btn btn-tweet">投稿する</button>
    </form>
  </div>
</div>
{% endblock %} {% block scripts %}
<script>
  // デフォルトチャンネルは既にテンプレートで設定済み
  
  document.getElementById("content").addEventListener("input", function () {
    const charCount = this.value.length;
    const charCountElement = document.getElementById("charCount");
    charCountElement.textContent = charCount;

    // 文字数に応じたスタイリング
    if (charCount > 140) {
      charCountElement.className = "char-counter mt-1 danger";
    } else if (charCount > 120) {
      charCountElement.className = "char-counter mt-1 warning";
    } else {
      charCountElement.className = "char-counter mt-1";
    }
  });
</script>
{% endblock %}
